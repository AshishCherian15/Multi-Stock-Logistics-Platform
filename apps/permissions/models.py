from django.db import models
from django.contrib.auth.models import User

class UserRole(models.Model):
    ROLE_CHOICES = (
        ('superadmin', 'SuperAdmin'),
        ('admin', 'Admin (Partner)'),
        ('subadmin', 'SubAdmin (Supervisor)'),
        ('staff', 'Staff (Employee)'),
        ('customer', 'Customer'),
        ('guest', 'Guest'),
    )
    
    user = models.OneToOneField(User, on_delete=models.CASCADE, related_name='role')
    role = models.CharField(max_length=20, choices=ROLE_CHOICES, default='customer')
    scope = models.JSONField(default=dict, blank=True)  # For dept/store scoping
    created_at = models.DateTimeField(auto_now_add=True)
    updated_at = models.DateTimeField(auto_now=True)
    
    class Meta:
        db_table = 'user_roles'
    
    def __str__(self):
        return f"{self.user.username} - {self.get_role_display()}"
    
    def has_permission(self, module, action):
        """Check if role has permission for module action"""
        permissions = PERMISSION_MATRIX.get(self.role, {})
        module_perms = permissions.get(module, {})
        return module_perms.get(action, False)


# Comprehensive Permission Matrix for all 7 roles Ã— all modules
# Updated with Wishlist, Cart, Profile, About, Announcements, and System Status
PERMISSION_MATRIX = {'superadmin': {'profile': {'view': True, 'edit': True, 'upload_photo': True, 'change_password': True}, 'wishlist': {'view': True, 'add': True, 'remove': True, 'clear': True}, 'cart': {'view': True, 'add': True, 'update': True, 'remove': True, 'clear': True, 'checkout': True}, 'about': {'view': True, 'create': True, 'edit': True, 'delete': True}, 'announcements': {'view': True, 'create': True, 'edit': True, 'delete': True}, 'system_status': {'view': True, 'refresh': True}, 'products': {'view': True, 'create': True, 'edit': True, 'delete': True, 'export': True, 'import': True, 'barcode': True}, 'inventory': {'view': True, 'create': True, 'edit': True, 'delete': True, 'export': True, 'transfer': True, 'audit': True}, 'stock': {'view': True, 'adjust': True, 'transfer': True, 'alert': True, 'export': True, 'audit': True}, 'categories': {'view': True, 'create': True, 'edit': True, 'delete': True}, 'barcode': {'view': True, 'generate': True, 'scan': True, 'print': True}, 'orders': {'view': True, 'create': True, 'edit': True, 'delete': True, 'approve': True, 'cancel': True, 'export': True}, 'shipping': {'view': True, 'create': True, 'edit': True, 'delete': True, 'track': True, 'carriers': True, 'rates': True}, 'pos': {'view': True, 'create': True, 'process': True, 'refund': True}, 'quotations': {'view': True, 'create': True, 'edit': True, 'convert': True, 'delete': True}, 'returns': {'view': True, 'approve': True, 'refund': True, 'process': True}, 'customers': {'view': True, 'create': True, 'edit': True, 'delete': True, 'export': True}, 'suppliers': {'view': True, 'create': True, 'edit': True, 'delete': True, 'export': True}, 'users': {'view': True, 'create': True, 'edit': True, 'delete': True, 'promote': True, 'deactivate': True}, 'team': {'view': True, 'create': True, 'assign': True, 'manage': True}, 'permissions': {'view': True, 'create': True, 'edit': True, 'delete': True, 'grant': True}, 'marketplace': {'view': True, 'buy': True, 'manage': True, 'feature': True, 'moderate': True}, 'auctions': {'view': True, 'create': True, 'bid': True, 'moderate': True, 'end': True}, 'forums': {'view': True, 'post': True, 'reply': True, 'moderate': True, 'delete': True, 'pin': True, 'ban': True}, 'rentals': {'view': True, 'create': True, 'book': True, 'checkin': True, 'checkout': True, 'billing': True, 'export': True}, 'storage': {'view': True, 'create': True, 'assign': True, 'billing': True, 'export': True}, 'lockers': {'view': True, 'create': True, 'assign': True, 'access': True}, 'billing': {'view': True, 'create': True, 'edit': True, 'delete': True, 'pdf': True, 'export': True}, 'expenses': {'view': True, 'create': True, 'approve': True, 'export': True}, 'credit': {'view': True, 'set_limit': True, 'approve': True, 'export': True}, 'coupons': {'view': True, 'create': True, 'edit': True, 'delete': True}, 'payments': {'view': True, 'process': True, 'refund': True}, 'analytics': {'view': True, 'create': True, 'export': True, 'configure': True}, 'reports': {'view': True, 'create': True, 'schedule': True, 'export': True, 'delete': True}, 'audit': {'view': True, 'export': True, 'purge': False}, 'settings': {'view': True, 'edit': True, 'configure': True, 'backup': True, 'restore': True}, 'warehouses': {'view': True, 'create': True, 'edit': True, 'delete': True, 'configure': True}, 'automation': {'view': True, 'create': True, 'edit': True, 'delete': True}, 'webhooks': {'view': True, 'create': True, 'edit': True, 'delete': True, 'logs': True}, 'subscriptions': {'view': True, 'manage': True, 'billing': True}, 'support': {'view': True, 'create': True, 'assign': True, 'resolve': True, 'delete': True}, 'messaging': {'view': True, 'send': True, 'group': True, 'moderate': True}, 'notifications': {'view': True, 'send': True, 'configure': True}, 'gamification': {'view': True, 'configure': True, 'award': True}, 'mobile_api': {'view': True, 'access': True}}, 'admin': {'profile': {'view': True, 'edit': True, 'upload_photo': True, 'change_password': True}, 'wishlist': {'view': True, 'add': True, 'remove': True, 'clear': True}, 'cart': {'view': True, 'add': True, 'update': True, 'remove': True, 'clear': True, 'checkout': True}, 'about': {'view': True, 'create': True, 'edit': True, 'delete': True}, 'announcements': {'view': True, 'create': True, 'edit': True, 'delete': True}, 'system_status': {'view': True, 'refresh': True}, 'products': {'view': True, 'create': True, 'edit': True, 'delete': True, 'export': True, 'import': True, 'barcode': True}, 'inventory': {'view': True, 'create': True, 'edit': True, 'delete': True, 'export': True, 'transfer': True, 'audit': True}, 'stock': {'view': True, 'adjust': True, 'transfer': True, 'alert': True, 'export': True, 'audit': True}, 'categories': {'view': True, 'create': True, 'edit': True, 'delete': True}, 'barcode': {'view': True, 'generate': True, 'scan': True, 'print': True}, 'orders': {'view': True, 'create': True, 'edit': True, 'delete': True, 'approve': True, 'cancel': True, 'export': True}, 'shipping': {'view': True, 'create': True, 'edit': True, 'delete': True, 'track': True, 'carriers': True, 'rates': True}, 'pos': {'view': True, 'create': True, 'process': True, 'refund': True}, 'quotations': {'view': True, 'create': True, 'edit': True, 'convert': True, 'delete': True}, 'returns': {'view': True, 'approve': True, 'refund': True, 'process': True}, 'customers': {'view': True, 'create': True, 'edit': True, 'delete': True, 'export': True}, 'suppliers': {'view': True, 'create': True, 'edit': True, 'delete': True, 'export': True}, 'users': {'view': True, 'create': True, 'edit': True, 'delete': False, 'promote': False, 'deactivate': True}, 'team': {'view': True, 'create': True, 'assign': True, 'manage': True}, 'permissions': {'view': True, 'create': False, 'edit': True, 'delete': False, 'grant': True}, 'marketplace': {'view': True, 'buy': True, 'manage': True, 'feature': True, 'moderate': True}, 'auctions': {'view': True, 'create': True, 'bid': True, 'moderate': True, 'end': True}, 'forums': {'view': True, 'post': True, 'reply': True, 'moderate': True, 'delete': True, 'pin': True, 'ban': True}, 'rentals': {'view': True, 'create': True, 'book': True, 'checkin': True, 'checkout': True, 'billing': True, 'export': True}, 'storage': {'view': True, 'create': True, 'assign': True, 'billing': True, 'export': True}, 'lockers': {'view': True, 'create': True, 'assign': True, 'access': True}, 'billing': {'view': True, 'create': True, 'edit': True, 'delete': True, 'pdf': True, 'export': True}, 'expenses': {'view': True, 'create': True, 'approve': True, 'export': True}, 'credit': {'view': True, 'set_limit': True, 'approve': True, 'export': True}, 'coupons': {'view': True, 'create': True, 'edit': True, 'delete': True}, 'payments': {'view': True, 'process': True, 'refund': True}, 'analytics': {'view': True, 'create': True, 'export': True, 'configure': False}, 'reports': {'view': True, 'create': True, 'schedule': True, 'export': True, 'delete': False}, 'audit': {'view': True, 'export': True, 'purge': False}, 'settings': {'view': True, 'edit': True, 'configure': False, 'backup': False, 'restore': False}, 'warehouses': {'view': True, 'create': True, 'edit': True, 'delete': False, 'configure': True}, 'automation': {'view': True, 'create': True, 'edit': True, 'delete': True}, 'webhooks': {'view': True, 'create': True, 'edit': True, 'delete': True, 'logs': True}, 'subscriptions': {'view': True, 'manage': True, 'billing': True}, 'support': {'view': True, 'create': True, 'assign': True, 'resolve': True, 'delete': False}, 'messaging': {'view': True, 'send': True, 'group': True, 'moderate': True}, 'notifications': {'view': True, 'send': True, 'configure': True}, 'gamification': {'view': True, 'configure': True, 'award': True}, 'mobile_api': {'view': True, 'access': True}}, 'admin': {'profile': {'view': True, 'edit': True, 'upload_photo': True, 'change_password': True}, 'wishlist': {'view': True, 'add': True, 'remove': True, 'clear': True}, 'cart': {'view': True, 'add': True, 'update': True, 'remove': True, 'clear': True, 'checkout': True}, 'about': {'view': True, 'create': False, 'edit': False, 'delete': False}, 'announcements': {'view': True, 'create': False, 'edit': False, 'delete': False}, 'system_status': {'view': True, 'refresh': True}, 'products': {'view': True, 'create': True, 'edit': True, 'delete': True, 'export': False, 'import': False, 'barcode': True}, 'inventory': {'view': True, 'create': True, 'edit': True, 'delete': False, 'export': True, 'transfer': False, 'audit': False}, 'stock': {'view': True, 'adjust': True, 'transfer': False, 'alert': True, 'export': True, 'audit': False}, 'categories': {'view': True, 'create': False, 'edit': False, 'delete': False}, 'barcode': {'view': True, 'generate': True, 'scan': True, 'print': True}, 'orders': {'view': True, 'create': True, 'edit': True, 'delete': False, 'approve': True, 'cancel': True, 'export': True}, 'shipping': {'view': True, 'create': True, 'edit': True, 'delete': False, 'track': True, 'carriers': False, 'rates': False}, 'pos': {'view': True, 'create': True, 'process': True, 'refund': True}, 'quotations': {'view': True, 'create': True, 'edit': True, 'convert': True, 'delete': False}, 'returns': {'view': True, 'approve': True, 'refund': True, 'process': True}, 'customers': {'view': True, 'create': True, 'edit': True, 'delete': False, 'export': True}, 'suppliers': {'view': True, 'create': True, 'edit': True, 'delete': False, 'export': True}, 'users': {'view': True, 'create': True, 'edit': False, 'delete': False, 'promote': False, 'deactivate': True}, 'team': {'view': True, 'create': True, 'assign': True, 'manage': True}, 'permissions': {'view': False, 'create': False, 'edit': False, 'delete': False, 'grant': False}, 'marketplace': {'view': True, 'buy': True, 'manage': False, 'feature': False, 'moderate': False}, 'auctions': {'view': True, 'create': True, 'bid': True, 'moderate': False, 'end': False}, 'forums': {'view': True, 'post': True, 'reply': True, 'moderate': False, 'delete': False, 'pin': False, 'ban': False}, 'rentals': {'view': True, 'create': True, 'book': True, 'checkin': True, 'checkout': True, 'billing': True, 'export': True}, 'storage': {'view': True, 'create': True, 'assign': True, 'billing': True, 'export': True}, 'lockers': {'view': True, 'create': True, 'assign': True, 'access': True}, 'billing': {'view': True, 'create': True, 'edit': True, 'delete': False, 'pdf': True, 'export': True}, 'expenses': {'view': True, 'create': True, 'approve': False, 'export': True}, 'credit': {'view': True, 'set_limit': False, 'approve': False, 'export': False}, 'coupons': {'view': True, 'create': True, 'edit': True, 'delete': False}, 'payments': {'view': True, 'process': True, 'refund': False}, 'analytics': {'view': True, 'create': False, 'export': True, 'configure': False}, 'reports': {'view': True, 'create': True, 'schedule': False, 'export': True, 'delete': False}, 'audit': {'view': True, 'export': False, 'purge': False}, 'settings': {'view': True, 'edit': False, 'configure': False, 'backup': False, 'restore': False}, 'warehouses': {'view': True, 'create': False, 'edit': False, 'delete': False, 'configure': False}, 'automation': {'view': True, 'create': False, 'edit': False, 'delete': False}, 'webhooks': {'view': False, 'create': False, 'edit': False, 'delete': False, 'logs': False}, 'subscriptions': {'view': True, 'manage': False, 'billing': False}, 'support': {'view': True, 'create': True, 'assign': True, 'resolve': True, 'delete': False}, 'messaging': {'view': True, 'send': True, 'group': True, 'moderate': False}, 'notifications': {'view': True, 'send': True, 'configure': False}, 'gamification': {'view': True, 'configure': False, 'award': False}, 'mobile_api': {'view': True, 'access': True}}, 'subadmin': {'profile': {'view': True, 'edit': True, 'upload_photo': True, 'change_password': True}, 'wishlist': {'view': True, 'add': True, 'remove': True, 'clear': True}, 'cart': {'view': True, 'add': True, 'update': True, 'remove': True, 'clear': True, 'checkout': True}, 'about': {'view': True, 'create': False, 'edit': False, 'delete': False}, 'announcements': {'view': True, 'create': False, 'edit': False, 'delete': False}, 'system_status': {'view': True, 'refresh': False}, 'products': {'view': True, 'create': True, 'edit': True, 'delete': True, 'export': False, 'import': False, 'barcode': True}, 'inventory': {'view': True, 'create': False, 'edit': True, 'delete': False, 'export': False, 'transfer': False, 'audit': False}, 'stock': {'view': True, 'adjust': True, 'transfer': False, 'alert': True, 'export': False, 'audit': False}, 'categories': {'view': True, 'create': False, 'edit': False, 'delete': False}, 'barcode': {'view': True, 'generate': True, 'scan': True, 'print': True}, 'orders': {'view': True, 'create': True, 'edit': True, 'delete': False, 'approve': False, 'cancel': True, 'export': False}, 'shipping': {'view': True, 'create': False, 'edit': True, 'delete': False, 'track': True, 'carriers': False, 'rates': False}, 'pos': {'view': True, 'create': True, 'process': True, 'refund': False}, 'quotations': {'view': True, 'create': True, 'edit': True, 'convert': False, 'delete': False}, 'returns': {'view': True, 'approve': False, 'refund': False, 'process': True}, 'customers': {'view': True, 'create': True, 'edit': True, 'delete': False, 'export': False}, 'suppliers': {'view': True, 'create': True, 'edit': True, 'delete': False, 'export': False}, 'users': {'view': True, 'create': False, 'edit': False, 'delete': False, 'promote': False, 'deactivate': False}, 'team': {'view': True, 'create': False, 'assign': True, 'manage': False}, 'permissions': {'view': False, 'create': False, 'edit': False, 'delete': False, 'grant': False}, 'marketplace': {'view': True, 'buy': True, 'manage': False, 'feature': False, 'moderate': False}, 'auctions': {'view': True, 'create': True, 'bid': True, 'moderate': False, 'end': False}, 'forums': {'view': True, 'post': True, 'reply': True, 'moderate': False, 'delete': False, 'pin': False, 'ban': False}, 'rentals': {'view': True, 'create': False, 'book': True, 'checkin': True, 'checkout': True, 'billing': False, 'export': False}, 'storage': {'view': True, 'create': False, 'assign': True, 'billing': False, 'export': False}, 'lockers': {'view': True, 'create': False, 'assign': True, 'access': True}, 'billing': {'view': True, 'create': True, 'edit': False, 'delete': False, 'pdf': True, 'export': False}, 'expenses': {'view': True, 'create': True, 'approve': False, 'export': False}, 'credit': {'view': False, 'set_limit': False, 'approve': False, 'export': False}, 'coupons': {'view': True, 'create': False, 'edit': False, 'delete': False}, 'payments': {'view': True, 'process': True, 'refund': False}, 'analytics': {'view': True, 'create': False, 'export': False, 'configure': False}, 'reports': {'view': True, 'create': False, 'schedule': False, 'export': True, 'delete': False}, 'audit': {'view': False, 'export': False, 'purge': False}, 'settings': {'view': False, 'edit': False, 'configure': False, 'backup': False, 'restore': False}, 'warehouses': {'view': True, 'create': False, 'edit': False, 'delete': False, 'configure': False}, 'automation': {'view': False, 'create': False, 'edit': False, 'delete': False}, 'webhooks': {'view': False, 'create': False, 'edit': False, 'delete': False, 'logs': False}, 'subscriptions': {'view': False, 'manage': False, 'billing': False}, 'support': {'view': True, 'create': True, 'assign': False, 'resolve': False, 'delete': False}, 'messaging': {'view': True, 'send': True, 'group': False, 'moderate': False}, 'notifications': {'view': True, 'send': False, 'configure': False}, 'gamification': {'view': True, 'configure': False, 'award': False}, 'mobile_api': {'view': True, 'access': True}}, 'staff': {'profile': {'view': True, 'edit': True, 'upload_photo': True, 'change_password': True}, 'wishlist': {'view': True, 'add': True, 'remove': True, 'clear': True}, 'cart': {'view': True, 'add': True, 'update': True, 'remove': True, 'clear': True, 'checkout': True}, 'about': {'view': True, 'create': False, 'edit': False, 'delete': False}, 'announcements': {'view': True, 'create': False, 'edit': False, 'delete': False}, 'system_status': {'view': False, 'refresh': False}, 'products': {'view': True, 'create': True, 'edit': False, 'delete': True, 'export': False, 'import': False, 'barcode': True, 'approve': False}, 'inventory': {'view': True, 'create': False, 'edit': False, 'delete': False, 'export': False, 'transfer': False, 'audit': False}, 'stock': {'view': True, 'adjust': False, 'transfer': False, 'alert': False, 'export': False, 'audit': False}, 'categories': {'view': True, 'create': False, 'edit': False, 'delete': False}, 'barcode': {'view': True, 'generate': True, 'scan': True, 'print': False}, 'orders': {'view': True, 'create': True, 'edit': False, 'delete': False, 'approve': False, 'cancel': False, 'export': False}, 'shipping': {'view': True, 'create': False, 'edit': False, 'delete': False, 'track': True, 'carriers': False, 'rates': False}, 'pos': {'view': True, 'create': True, 'process': True, 'refund': False}, 'quotations': {'view': True, 'create': False, 'edit': False, 'convert': False, 'delete': False}, 'returns': {'view': True, 'approve': False, 'refund': False, 'process': False}, 'customers': {'view': True, 'create': True, 'edit': True, 'delete': False, 'export': False}, 'suppliers': {'view': True, 'create': False, 'edit': False, 'delete': False, 'export': False}, 'users': {'view': False, 'create': False, 'edit': False, 'delete': False, 'promote': False, 'deactivate': False}, 'team': {'view': False, 'create': False, 'assign': False, 'manage': False}, 'permissions': {'view': False, 'create': False, 'edit': False, 'delete': False, 'grant': False}, 'marketplace': {'view': True, 'buy': False, 'manage': False, 'feature': False, 'moderate': False}, 'auctions': {'view': True, 'create': False, 'bid': False, 'moderate': False, 'end': False}, 'forums': {'view': True, 'post': False, 'reply': False, 'moderate': False, 'delete': False, 'pin': False, 'ban': False}, 'rentals': {'view': True, 'create': False, 'book': False, 'checkin': False, 'checkout': False, 'billing': False, 'export': False}, 'storage': {'view': True, 'create': False, 'assign': False, 'billing': False, 'export': False}, 'lockers': {'view': True, 'create': False, 'assign': False, 'access': False}, 'billing': {'view': True, 'create': False, 'edit': False, 'delete': False, 'pdf': False, 'export': False}, 'expenses': {'view': True, 'create': False, 'approve': False, 'export': False}, 'credit': {'view': False, 'set_limit': False, 'approve': False, 'export': False}, 'coupons': {'view': True, 'create': False, 'edit': False, 'delete': False}, 'payments': {'view': True, 'process': False, 'refund': False}, 'analytics': {'view': False, 'create': False, 'export': False, 'configure': False}, 'reports': {'view': False, 'create': False, 'schedule': False, 'export': False, 'delete': False}, 'audit': {'view': False, 'export': False, 'purge': False}, 'settings': {'view': False, 'edit': False, 'configure': False, 'backup': False, 'restore': False}, 'warehouses': {'view': True, 'create': False, 'edit': False, 'delete': False, 'configure': False}, 'automation': {'view': False, 'create': False, 'edit': False, 'delete': False}, 'webhooks': {'view': False, 'create': False, 'edit': False, 'delete': False, 'logs': False}, 'subscriptions': {'view': False, 'manage': False, 'billing': False}, 'support': {'view': True, 'create': True, 'assign': False, 'resolve': False, 'delete': False}, 'messaging': {'view': True, 'send': True, 'group': False, 'moderate': False}, 'notifications': {'view': True, 'send': False, 'configure': False}, 'gamification': {'view': True, 'configure': False, 'award': False}, 'mobile_api': {'view': True, 'access': True}}, 'customer': {'profile': {'view': True, 'edit': True, 'upload_photo': True, 'change_password': True}, 'wishlist': {'view': True, 'add': True, 'remove': True, 'clear': True}, 'cart': {'view': True, 'add': True, 'update': True, 'remove': True, 'clear': True, 'checkout': True}, 'about': {'view': True, 'create': False, 'edit': False, 'delete': False}, 'announcements': {'view': True, 'create': False, 'edit': False, 'delete': False}, 'system_status': {'view': False, 'refresh': False}, 'products': {'view': True, 'create': False, 'edit': False, 'delete': False, 'export': False, 'import': False, 'barcode': False}, 'inventory': {'view': False, 'create': False, 'edit': False, 'delete': False, 'export': False, 'transfer': False, 'audit': False}, 'stock': {'view': False, 'adjust': False, 'transfer': False, 'alert': False, 'export': False, 'audit': False}, 'categories': {'view': True, 'create': False, 'edit': False, 'delete': False}, 'barcode': {'view': False, 'generate': False, 'scan': False, 'print': False}, 'orders': {'view': True, 'create': True, 'edit': False, 'delete': False, 'approve': False, 'cancel': False, 'export': False}, 'shipping': {'view': True, 'create': False, 'edit': False, 'delete': False, 'track': True, 'carriers': False, 'rates': False}, 'pos': {'view': True, 'create': True, 'process': True, 'refund': False}, 'quotations': {'view': True, 'create': True, 'edit': False, 'convert': False, 'delete': False}, 'returns': {'view': True, 'approve': False, 'refund': False, 'process': True}, 'customers': {'view': False, 'create': False, 'edit': False, 'delete': False, 'export': False}, 'suppliers': {'view': False, 'create': False, 'edit': False, 'delete': False, 'export': False}, 'users': {'view': False, 'create': False, 'edit': False, 'delete': False, 'promote': False, 'deactivate': False}, 'team': {'view': False, 'create': False, 'assign': False, 'manage': False}, 'permissions': {'view': False, 'create': False, 'edit': False, 'delete': False, 'grant': False}, 'marketplace': {'view': True, 'buy': True, 'manage': False, 'feature': False, 'moderate': False}, 'auctions': {'view': True, 'create': True, 'bid': True, 'moderate': False, 'end': False}, 'forums': {'view': True, 'post': True, 'reply': True, 'moderate': False, 'delete': False, 'pin': False, 'ban': False}, 'rentals': {'view': True, 'create': False, 'book': True, 'checkin': False, 'checkout': False, 'billing': False, 'export': False}, 'storage': {'view': True, 'create': False, 'assign': False, 'billing': False, 'export': False}, 'lockers': {'view': True, 'create': False, 'assign': False, 'access': False}, 'billing': {'view': True, 'create': False, 'edit': False, 'delete': False, 'pdf': True, 'export': False}, 'expenses': {'view': False, 'create': False, 'approve': False, 'export': False}, 'credit': {'view': True, 'set_limit': False, 'approve': False, 'export': False}, 'coupons': {'view': True, 'create': False, 'edit': False, 'delete': False}, 'payments': {'view': True, 'process': True, 'refund': False}, 'analytics': {'view': False, 'create': False, 'export': False, 'configure': False}, 'reports': {'view': False, 'create': False, 'schedule': False, 'export': False, 'delete': False}, 'audit': {'view': False, 'export': False, 'purge': False}, 'settings': {'view': False, 'edit': False, 'configure': False, 'backup': False, 'restore': False}, 'warehouses': {'view': False, 'create': False, 'edit': False, 'delete': False, 'configure': False}, 'automation': {'view': False, 'create': False, 'edit': False, 'delete': False}, 'webhooks': {'view': False, 'create': False, 'edit': False, 'delete': False, 'logs': False}, 'subscriptions': {'view': False, 'manage': False, 'billing': False}, 'support': {'view': False, 'create': False, 'assign': False, 'resolve': False, 'delete': False}, 'messaging': {'view': True, 'send': True, 'group': False, 'moderate': False}, 'notifications': {'view': True, 'send': False, 'configure': False}, 'gamification': {'view': True, 'configure': False, 'award': False}, 'mobile_api': {'view': True, 'access': True}}, 'guest': {'products': {'view': True, 'create': False, 'edit': False, 'delete': False, 'export': False, 'import': False, 'barcode': False}, 'inventory': {'view': False, 'create': False, 'edit': False, 'delete': False, 'export': False, 'transfer': False, 'audit': False}, 'stock': {'view': False, 'adjust': False, 'transfer': False, 'alert': False, 'export': False, 'audit': False}, 'categories': {'view': True, 'create': False, 'edit': False, 'delete': False}, 'barcode': {'view': False, 'generate': False, 'scan': False, 'print': False}, 'orders': {'view': False, 'create': False, 'edit': False, 'delete': False, 'approve': False, 'cancel': False, 'export': False}, 'pos': {'view': False, 'create': False, 'process': False, 'refund': False}, 'quotations': {'view': False, 'create': False, 'edit': False, 'convert': False, 'delete': False}, 'returns': {'view': False, 'approve': False, 'refund': False, 'process': False}, 'customers': {'view': False, 'create': False, 'edit': False, 'delete': False, 'export': False}, 'suppliers': {'view': False, 'create': False, 'edit': False, 'delete': False, 'export': False}, 'users': {'view': False, 'create': False, 'edit': False, 'delete': False, 'promote': False, 'deactivate': False}, 'team': {'view': False, 'create': False, 'assign': False, 'manage': False}, 'permissions': {'view': False, 'create': False, 'edit': False, 'delete': False, 'grant': False}, 'marketplace': {'view': True, 'buy': False, 'manage': False, 'feature': False, 'moderate': False}, 'auctions': {'view': True, 'create': False, 'bid': False, 'moderate': False, 'end': False}, 'forums': {'view': True, 'post': False, 'reply': False, 'moderate': False, 'delete': False, 'pin': False, 'ban': False}, 'rentals': {'view': True, 'create': False, 'book': False, 'checkin': False, 'checkout': False, 'billing': False, 'export': False}, 'storage': {'view': True, 'create': False, 'assign': False, 'billing': False, 'export': False}, 'lockers': {'view': True, 'create': False, 'assign': False, 'access': False}, 'billing': {'view': False, 'create': False, 'edit': False, 'delete': False, 'pdf': False, 'export': False}, 'expenses': {'view': False, 'create': False, 'approve': False, 'export': False}, 'credit': {'view': False, 'set_limit': False, 'approve': False, 'export': False}, 'coupons': {'view': False, 'create': False, 'edit': False, 'delete': False}, 'payments': {'view': False, 'process': False, 'refund': False}, 'analytics': {'view': False, 'create': False, 'export': False, 'configure': False}, 'reports': {'view': False, 'create': False, 'schedule': False, 'export': False, 'delete': False}, 'audit': {'view': False, 'export': False, 'purge': False}, 'settings': {'view': False, 'edit': False, 'configure': False, 'backup': False, 'restore': False}, 'warehouses': {'view': False, 'create': False, 'edit': False, 'delete': False, 'configure': False}, 'automation': {'view': False, 'create': False, 'edit': False, 'delete': False}, 'webhooks': {'view': False, 'create': False, 'edit': False, 'delete': False, 'logs': False}, 'subscriptions': {'view': False, 'manage': False, 'billing': False}, 'support': {'view': False, 'create': False, 'assign': False, 'resolve': False, 'delete': False}, 'messaging': {'view': False, 'send': False, 'group': False, 'moderate': False}, 'notifications': {'view': False, 'send': False, 'configure': False}, 'gamification': {'view': False, 'configure': False, 'award': False}, 'mobile_api': {'view': False, 'access': False}, 'profile': {'view': False, 'edit': False, 'upload_photo': False, 'change_password': False}, 'wishlist': {'view': False, 'add': False, 'remove': False, 'clear': False}, 'cart': {'view': False, 'add': False, 'update': False, 'remove': False, 'clear': False, 'checkout': False}, 'about': {'view': True, 'create': False, 'edit': False, 'delete': False}, 'announcements': {'view': False, 'create': False, 'edit': False, 'delete': False}, 'system_status': {'view': False, 'refresh': False}}}
