{% extends 'base.html' %}
{% block title %}Receipt {{ receipt.receipt_number }}{% endblock %}
{% block content %}
<style>
@import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;600;700&display=swap');
:root{--primary:#1A73E8;--success:#28a745;--secondary:#F5F5F5}
.receipt-container{background:#fff;border-radius:8px;box-shadow:0 2px 15px rgba(0,0,0,0.1);padding:2.5rem;max-width:800px;margin:0 auto;font-family:'Roboto',sans-serif}
.receipt-header{display:flex;justify-content:space-between;align-items:center;border-bottom:2px solid var(--primary);padding-bottom:1rem;margin-bottom:1.5rem}
.logo{font-size:26px;font-weight:700;color:var(--primary);letter-spacing:1px}
.receipt-label{font-size:28px;font-weight:700;color:var(--primary);text-transform:uppercase}
.receipt-meta{text-align:right;font-size:13px;margin-top:0.5rem;line-height:1.8}
.paid-badge{display:inline-block;background:var(--success);color:#fff;padding:4px 12px;border-radius:20px;font-weight:600;font-size:11px;text-transform:uppercase}
.customer-section{background:var(--secondary);padding:15px;margin:1rem 0;border-radius:4px}
.customer-section h5{font-size:16px;font-weight:600;color:var(--primary);margin-bottom:0.5rem}
.customer-section p{line-height:1.6;margin:3px 0;font-size:13px}
.items-table{width:100%;border-collapse:collapse;margin:1.5rem 0}
.items-table thead{background:var(--primary);color:#fff}
.items-table th{padding:12px;text-align:left;font-weight:600;font-size:12px;text-transform:uppercase}
.items-table th:nth-child(2),.items-table th:nth-child(3){text-align:right}
.items-table td{padding:12px;border-bottom:1px solid #ddd;font-size:13px}
.items-table td:nth-child(2),.items-table td:nth-child(3){text-align:right}
.items-table tbody tr:nth-child(even){background:var(--secondary)}
.total-paid{text-align:right;margin:1rem 0;padding:15px;background:var(--primary);color:#fff;border-radius:4px}
.total-paid h5{font-size:16px;margin-bottom:5px}
.total-paid h3{font-size:24px;font-weight:700}
.payment-confirmation{background:#E6F4EA;padding:15px;margin:1rem 0;border-left:4px solid var(--success);border-radius:4px}
.payment-confirmation h5{font-size:16px;font-weight:600;color:var(--success);margin-bottom:10px}
.payment-confirmation p{font-size:13px;line-height:1.8;margin:4px 0}
.qr-section{text-align:center;padding:1.5rem;background:var(--secondary);border-radius:4px;margin:1.5rem 0}
.qr-section h5{font-size:14px;font-weight:600;color:var(--primary);margin-bottom:10px}
.qr-code{width:120px;height:120px;margin:10px auto;background:#fff;border:2px solid var(--primary);border-radius:8px;display:flex;align-items:center;justify-content:center}
.action-btn{border-radius:8px;padding:0.6rem 1.5rem;font-weight:600;margin:0.25rem}
</style>

<div class="container-fluid py-4">
    <div class="receipt-container">
        <!-- Header -->
        <div class="receipt-header">
            <div class="logo">MULTISTOCK</div>
            <div>
                <div class="receipt-label">RECEIPT</div>
                <div class="receipt-meta">
                    <strong>{{ receipt.receipt_number }}</strong><br>
                    Date: {{ receipt.payment_date|date:"M d, Y" }}<br>
                    <span class="paid-badge">PAID</span>
                </div>
            </div>
        </div>

        <!-- Customer Info -->
        <div class="customer-section">
            <h5>CUSTOMER</h5>
            <p><strong>{{ receipt.invoice.customer_name }}</strong></p>
            <p>Email: {{ receipt.invoice.customer_email }}</p>
            <p>Phone: {{ receipt.invoice.customer_phone }}</p>
            <p>Address: {{ receipt.invoice.customer_address }}</p>
        </div>
        
        <!-- Items Table -->
        <table class="items-table">
            <thead>
                <tr>
                    <th style="width:60%">ITEM</th>
                    <th style="width:20%">QUANTITY</th>
                    <th style="width:20%">PAID AMOUNT</th>
                </tr>
            </thead>
            <tbody>
                {% for item in receipt.invoice.items.all %}
                <tr>
                    <td>{{ item.description }}</td>
                    <td>{{ item.quantity }}</td>
                    <td>₹{{ item.amount }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        
        <!-- Total Paid -->
        <div class="total-paid">
            <h5>TOTAL AMOUNT PAID</h5>
            <h3>₹{{ receipt.amount_paid }}</h3>
        </div>
        
        <!-- Payment Confirmation -->
        <div class="payment-confirmation">
            <h5>✓ PAYMENT CONFIRMATION</h5>
            <p><strong>Payment Method:</strong> {{ receipt.payment_mode|title }}</p>
            <p><strong>Transaction ID:</strong> {{ receipt.receipt_number }}</p>
            <p><strong>Date of Payment:</strong> {{ receipt.payment_date|date:"F d, Y" }}</p>
            <p><strong>Invoice Reference:</strong> {{ receipt.invoice.invoice_number }}</p>
            <p><strong>Status:</strong> <span class="paid-badge">Payment Received</span></p>
        </div>

        <!-- QR Code -->
        <div class="qr-section">
            <h5>RECEIPT VERIFICATION</h5>
            <div class="qr-code">
                <svg width="80" height="80" viewBox="0 0 100 100">
                    <rect x="0" y="0" width="20" height="20" fill="#1A73E8"/>
                    <rect x="25" y="0" width="20" height="20" fill="#1A73E8"/>
                    <rect x="50" y="0" width="20" height="20" fill="#1A73E8"/>
                    <rect x="75" y="0" width="20" height="20" fill="#1A73E8"/>
                    <rect x="0" y="25" width="20" height="20" fill="#1A73E8"/>
                    <rect x="50" y="25" width="20" height="20" fill="#1A73E8"/>
                    <rect x="0" y="50" width="20" height="20" fill="#1A73E8"/>
                    <rect x="25" y="50" width="20" height="20" fill="#1A73E8"/>
                    <rect x="75" y="50" width="20" height="20" fill="#1A73E8"/>
                    <rect x="0" y="75" width="20" height="20" fill="#1A73E8"/>
                    <rect x="50" y="75" width="20" height="20" fill="#1A73E8"/>
                    <rect x="75" y="75" width="20" height="20" fill="#1A73E8"/>
                </svg>
            </div>
            <p style="font-size:10px;color:#666;margin-top:8px">{{ receipt.qr_code }}</p>
            <p style="font-size:11px">Scan to verify receipt authenticity</p>
        </div>
        
        <div class="text-center my-4">
            <h5 style="color:var(--success);font-weight:700">Payment Received. Thank you!</h5>
            <p style="font-size:11px;color:#666;margin-top:10px">This is a computer-generated receipt and does not require a signature.</p>
        </div>

        <!-- Actions -->
        <div class="text-center mt-4">
            <a href="{% url 'billing:invoice_detail' receipt.invoice.id %}" class="btn btn-outline-secondary action-btn"><i class="fas fa-arrow-left me-1"></i>Back to Invoice</a>
            <a href="{% url 'billing:receipt_detail' receipt.id %}" class="btn btn-primary action-btn" style="background:linear-gradient(135deg,var(--zaffre),#000E75)"><i class="fas fa-eye me-1"></i>View Receipt</a>
            <a href="{% url 'billing:receipt_pdf' receipt.id %}" class="btn btn-success action-btn"><i class="fas fa-download me-1"></i>Download Receipt PDF</a>
            <button onclick="window.print()" class="btn btn-info action-btn"><i class="fas fa-print me-1"></i>Print Receipt</button>
        </div>

        <!-- Timestamp -->
        <div class="text-center mt-4">
            <small class="text-muted">Generated on {{ receipt.created_at|date:"F d, Y h:i A" }}</small>
        </div>
    </div>
</div>

<style media="print">
@media print {
    .btn, nav, .navbar { display: none !important; }
    .receipt-container { box-shadow: none; }
}
</style>
{% endblock %}
