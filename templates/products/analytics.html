{% extends 'base.html' %}
{% load static %}

{% block title %}Product Analytics{% endblock %}

{% block extra_css %}
<style>
.analytics-card {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    border-radius: 15px;
    padding: 25px;
    margin-bottom: 20px;
}
.metric-card {
    background: white;
    border-radius: 10px;
    padding: 20px;
    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    text-align: center;
}
.trend-up { color: #28a745; }
.trend-down { color: #dc3545; }
.chart-container {
    background: white;
    border-radius: 10px;
    padding: 20px;
    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
}
</style>
{% endblock %}

{% block content %}
<div class="container-fluid">
    <div class="row mb-4">
        <div class="col-12">
            <div class="analytics-card">
                <h2><i class="fas fa-chart-line me-2"></i>Product Analytics Dashboard</h2>
                <p>Comprehensive insights for Product ID: {{ request.GET.id|default:"1" }}</p>
            </div>
        </div>
    </div>

    <div class="row mb-4">
        <div class="col-md-3">
            <div class="metric-card">
                <h3>â‚¹45,678</h3>
                <p>Total Revenue</p>
                <small class="trend-up"><i class="fas fa-arrow-up"></i> +12.5%</small>
            </div>
        </div>
        <div class="col-md-3">
            <div class="metric-card">
                <h3>234</h3>
                <p>Units Sold</p>
                <small class="trend-up"><i class="fas fa-arrow-up"></i> +8.3%</small>
            </div>
        </div>
        <div class="col-md-3">
            <div class="metric-card">
                <h3>45</h3>
                <p>Current Stock</p>
                <small class="trend-down"><i class="fas fa-arrow-down"></i> -15.2%</small>
            </div>
        </div>
        <div class="col-md-3">
            <div class="metric-card">
                <h3>4.8/5</h3>
                <p>Avg Rating</p>
                <small class="trend-up"><i class="fas fa-arrow-up"></i> +0.2</small>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-md-8">
            <div class="chart-container">
                <h5>Sales Trend (Last 30 Days)</h5>
                <canvas id="salesChart" height="100"></canvas>
            </div>
        </div>
        <div class="col-md-4">
            <div class="chart-container">
                <h5>Stock Movement</h5>
                <canvas id="stockChart" height="200"></canvas>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
// Sales trend chart
const salesCtx = document.getElementById('salesChart').getContext('2d');
new Chart(salesCtx, {
    type: 'line',
    data: {
        labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4'],
        datasets: [{
            label: 'Sales',
            data: [12, 19, 15, 25],
            borderColor: '#007bff',
            backgroundColor: 'rgba(0,123,255,0.1)',
            tension: 0.4
        }]
    },
    options: {
        responsive: true,
        maintainAspectRatio: false
    }
});

// Stock movement chart
const stockCtx = document.getElementById('stockChart').getContext('2d');
new Chart(stockCtx, {
    type: 'doughnut',
    data: {
        labels: ['Sold', 'In Stock', 'Reserved'],
        datasets: [{
            data: [234, 45, 12],
            backgroundColor: ['#28a745', '#007bff', '#ffc107']
        }]
    },
    options: {
        responsive: true,
        maintainAspectRatio: false
    }
});
</script>
{% endblock %}
